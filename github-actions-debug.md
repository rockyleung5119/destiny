# ğŸ” GitHub Actionsåç«¯éƒ¨ç½²å¤±è´¥è¯Šæ–­æŠ¥å‘Š

## ğŸ“Š é—®é¢˜åˆ†æ

### å½“å‰çŠ¶æ€
- âœ… **å‰ç«¯éƒ¨ç½²æˆåŠŸ** - Cloudflare Pageséƒ¨ç½²æ­£å¸¸
- âŒ **åç«¯éƒ¨ç½²å¤±è´¥** - Cloudflare Workerséƒ¨ç½²å¤±è´¥
- âœ… **æœ¬åœ°é…ç½®æ­£å¸¸** - æ‰€æœ‰wrangleræµ‹è¯•é€šè¿‡

### å¯èƒ½çš„å¤±è´¥åŸå› 

#### 1. **æ–‡ä»¶å¤§å°é—®é¢˜**
- **worker.tsæ–‡ä»¶å¾ˆå¤§** (5448è¡Œï¼Œçº¦300KB)
- **åŒ…å«å¤§é‡å†…è”HTMLæ¨¡æ¿**
- **GitHub Actionså¯èƒ½æœ‰ä¸Šä¼ é™åˆ¶**

#### 2. **å¤æ‚é…ç½®é—®é¢˜**
- **Durable Objects + Queues + D1 + R2** å¤æ‚é…ç½®
- **è¿ç§»é…ç½®å¯èƒ½åœ¨CIç¯å¢ƒä¸­å†²çª**
- **æƒé™è¦æ±‚è¾ƒé«˜**

#### 3. **ç½‘ç»œå’Œè¶…æ—¶é—®é¢˜**
- **GitHub Actionsç½‘ç»œç¯å¢ƒé™åˆ¶**
- **Cloudflare APIå“åº”è¶…æ—¶**
- **å¤§æ–‡ä»¶ä¸Šä¼ è¶…æ—¶**

#### 4. **API Tokenæƒé™é—®é¢˜**
- **å¯èƒ½ç¼ºå°‘Durable Objectsæƒé™**
- **å¯èƒ½ç¼ºå°‘Queuesç®¡ç†æƒé™**
- **å¯èƒ½ç¼ºå°‘è¿ç§»æ‰§è¡Œæƒé™**

## ğŸ”§ å·²å®æ–½çš„ä¿®å¤æªæ–½

### 1. **ä¼˜åŒ–éƒ¨ç½²é…ç½®**
```yaml
# ä¸»è¦éƒ¨ç½²ç­–ç•¥
command: deploy --config wrangler-github.toml --compatibility-date=2024-08-01 --no-bundle --minify=false

# å¤‡ç”¨éƒ¨ç½²ç­–ç•¥  
command: deploy --config wrangler-github.toml --compatibility-date=2024-08-01
```

### 2. **å¢åŠ è¶…æ—¶æ—¶é—´**
```yaml
timeout-minutes: 15  # ä»é»˜è®¤6åˆ†é’Ÿå¢åŠ åˆ°15åˆ†é’Ÿ
```

### 3. **æ·»åŠ åŒé‡éƒ¨ç½²ç­–ç•¥**
- **ä¸»è¦éƒ¨ç½²**: ä¼˜åŒ–å¤§æ–‡ä»¶å¤„ç† (`--no-bundle --minify=false`)
- **å¤‡ç”¨éƒ¨ç½²**: æ ‡å‡†å‹ç¼©éƒ¨ç½²
- **æ™ºèƒ½çŠ¶æ€æ£€æŸ¥**: ä»»ä¸€æˆåŠŸå³è§†ä¸ºéƒ¨ç½²æˆåŠŸ

### 4. **æ”¹è¿›é”™è¯¯å¤„ç†**
- **continue-on-error: true** é¿å…å•ç‚¹å¤±è´¥
- **è¯¦ç»†çš„é”™è¯¯è¯Šæ–­ä¿¡æ¯**
- **ä¸å½±å“å‰ç«¯éƒ¨ç½²æµç¨‹**

## ğŸš€ æ‰‹åŠ¨éƒ¨ç½²å¤‡ç”¨æ–¹æ¡ˆ

å¦‚æœGitHub Actionsç»§ç»­å¤±è´¥ï¼Œä½¿ç”¨æ‰‹åŠ¨éƒ¨ç½²ï¼š

### æ–¹æ³•1: ä½¿ç”¨ä¼˜åŒ–é…ç½®
```bash
cd backend
wrangler deploy --config wrangler-github.toml --compatibility-date=2024-08-01 --no-bundle --minify=false
```

### æ–¹æ³•2: ä½¿ç”¨æ ‡å‡†é…ç½®
```bash
cd backend  
wrangler deploy --config wrangler-github.toml
```

### æ–¹æ³•3: ä½¿ç”¨PowerShellè„šæœ¬
```powershell
.\manual-deploy-backend.ps1
```

## ğŸ“‹ GitHub Secretsæ£€æŸ¥æ¸…å•

ç¡®ä¿ä»¥ä¸‹Secretsæ­£ç¡®é…ç½®ï¼š

### CLOUDFLARE_API_TOKEN æƒé™è¦æ±‚
- âœ… **Account:Read**
- âœ… **Workers Scripts:Edit** 
- âœ… **Workers KV Storage:Edit**
- âœ… **Workers Durable Objects:Edit**
- âœ… **Cloudflare Queues:Edit**
- âœ… **D1:Edit**
- âœ… **R2:Edit**

### CLOUDFLARE_ACCOUNT_ID
- âœ… **æ­£ç¡®çš„è´¦æˆ·ID**
- âœ… **ä¸API TokenåŒ¹é…**

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. æ£€æŸ¥GitHub Actionsæ—¥å¿—
åœ¨GitHubä»“åº“ä¸­æŸ¥çœ‹Actionsæ ‡ç­¾é¡µï¼Œæ‰¾åˆ°å¤±è´¥çš„å·¥ä½œæµï¼ŒæŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚

### 2. æœ¬åœ°éªŒè¯
```bash
cd backend
wrangler whoami  # æ£€æŸ¥è®¤è¯
wrangler deploy --dry-run --config wrangler-github.toml  # æµ‹è¯•é…ç½®
```

### 3. æ‰‹åŠ¨éƒ¨ç½²æµ‹è¯•
å¦‚æœæœ¬åœ°éƒ¨ç½²æˆåŠŸï¼Œè¯´æ˜é—®é¢˜åœ¨GitHub Actionsç¯å¢ƒã€‚

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **æ¨é€å½“å‰ä¿®å¤** - æµ‹è¯•ä¼˜åŒ–åçš„GitHub Actions
2. **å¦‚æœä»ç„¶å¤±è´¥** - ä½¿ç”¨æ‰‹åŠ¨éƒ¨ç½²è„šæœ¬
3. **æ£€æŸ¥GitHub Secrets** - ç¡®ä¿API Tokenæƒé™å……è¶³
4. **ç›‘æ§éƒ¨ç½²æ—¥å¿—** - è·å–å…·ä½“é”™è¯¯ä¿¡æ¯

## ğŸ’¡ é•¿æœŸè§£å†³æ–¹æ¡ˆ

### 1. **ä»£ç ä¼˜åŒ–**
- å°†å¤§å‹HTMLæ¨¡æ¿ç§»åˆ°å¤–éƒ¨æ–‡ä»¶
- æ‹†åˆ†worker.tsä¸ºå¤šä¸ªæ¨¡å—
- ä½¿ç”¨åŠ¨æ€å¯¼å…¥å‡å°‘åˆå§‹åŒ…å¤§å°

### 2. **éƒ¨ç½²ç­–ç•¥ä¼˜åŒ–**
- ä½¿ç”¨åˆ†é˜¶æ®µéƒ¨ç½²
- å®æ–½è“ç»¿éƒ¨ç½²ç­–ç•¥
- æ·»åŠ éƒ¨ç½²å¥åº·æ£€æŸ¥

### 3. **ç›‘æ§å’Œå‘Šè­¦**
- æ·»åŠ éƒ¨ç½²çŠ¶æ€ç›‘æ§
- è®¾ç½®å¤±è´¥å‘Šè­¦
- å®æ–½è‡ªåŠ¨å›æ»šæœºåˆ¶

---

**å½“å‰ä¼˜å…ˆçº§**: å…ˆç¡®ä¿GitHub Actionsèƒ½å¤ŸæˆåŠŸéƒ¨ç½²ï¼Œä¿æŒæ‰€æœ‰åŠŸèƒ½å®Œæ•´ã€‚
